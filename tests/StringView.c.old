/**
 * @file StrView.c
 * @author WolodiaM (w_melnyk@outlook.com)
 * @brief Tests for string view
 *
 *
 * @date 2024-12-05
 * @copyright (C) 2024 WolodiaM
 * @license GPL-3.0-or-later
 *
 * Copyright (C) 2025 WolodiaM
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */
// Project includes
#include "../cbuild.h"
#include "framework.h"
#define CBUILD_IMPLEMENTATION
#include "../cbuild.h"
// Code
bool tdelim1(const cbuild_sv_t* sv, size_t idx, void* args) {
	CBUILD_UNUSED(idx);
	CBUILD_UNUSED(args);
	if(idx > 4 && sv->data[idx] == '|') {
		return true;
	}
	return false;
}
bool tdelim2(const cbuild_sv_t* sv, size_t idx, void* args) {
	CBUILD_UNUSED(sv);
	CBUILD_UNUSED(idx);
	CBUILD_UNUSED(args);
	return false;
}
bool tdelim3(const cbuild_sv_t* sv, void* arg) {
	cbuild_sv_t temp = *sv;
	uint32_t cp = cbuild_sv_chop_utf8(&temp);
	*(uint32_t*)arg = cp;
	return cp == 1092;
}
TEST_MAIN({
	TEST_CASE(
	{
		const char* str       = "Hello, world!";
		cbuild_sv_t sv        = cbuild_sv_from_cstr(str);
		char        fmt1[100] = { 0 };
		sprintf(fmt1, "%s", str);
		char fmt2[100] = { 0 };
		sprintf(fmt2, CBuildSVFmt, CBuildSVArg(sv));
		TEST_ASSERT_STREQ(
		  fmt1, fmt2,
		  "Wrong formatting of string view" TEST_EXPECT_MSG(s),
		  "Hello, world!", sv.data);
	},
	"StringView printing");
},
"StringView library tests")
